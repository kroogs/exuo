(this.webpackJsonpexuo=this.webpackJsonpexuo||[]).push([[0],{108:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(17),o=n(0),r=n.n(o),i=n(61),c=n(307),l=n(304),d=n(305),u=n(31),s=n(57),m=n(23),f=n(19),p=function(e){var t=e.id,n=r.a.useState(null),o=Object(a.a)(n,2),p=o[0],g=o[1],v=r.a.useState(!1),b=Object(a.a)(v,2),h=b[0],E=b[1],y=Object(u.c)();return Object(f.k)((function(e){return r.a.createElement(s.a,null,r.a.createElement(i.a,{align:"center"},"Someone wants to share content with you.",r.a.createElement("br",null),"Do not accept if you do not trust them."),r.a.createElement(c.a,{mt:1,textAlign:"center"},p?r.a.createElement(i.a,{color:"error"},p):r.a.createElement(l.a,{disabled:h,onClick:function(){E(!0),e.seekPeerConnection(t).then((function(e){y(Object(m.b)("/node/".concat(e.id)))})).catch((function(e){g(e)}))},color:"primary"},h?r.a.createElement(d.a,{size:24}):"Accept")))}))}},110:function(e,t){},152:function(e,t,n){"use strict";var a=n(108);n.d(t,"PeerConnector",(function(){return a.a}));n(110)},188:function(e,t,n){e.exports=n(299)},19:function(e,t,n){"use strict";n.d(t,"k",(function(){return i})),n.d(t,"a",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"c",(function(){return M})),n.d(t,"g",(function(){return S})),n.d(t,"b",(function(){return Ce})),n.d(t,"d",(function(){return tt})),n.d(t,"e",(function(){return rt})),n.d(t,"f",(function(){return it}));var a=n(0),o=n.n(a),r=n(89),i=function(e){return Object(r.c)((function(t){return e(t.graph)}))},c=o.a.createContext(null),l=c.Provider,d=function(){return o.a.useContext(c)},u=n(46),s=n(182),m=n(4),f=n(346),p=function(e){return m.i.model("EdgeMap",{edgeMap:m.i.map(m.i.array(m.i.safeReference(m.i.late(e),{acceptsUndefined:!1})))}).actions((function(e){return{hasEdge:function(t,n){var a,o;return n?Boolean(null===(a=e.edgeMap.get(t))||void 0===a?void 0:a.includes(n)):Boolean(null===(o=e.edgeMap.get(t))||void 0===o?void 0:o.length)}}})).actions((function(e){return{addEdge:function(t,n){var a;e.edgeMap.has(t)||e.edgeMap.set(t,[]),null===(a=e.edgeMap.get(t))||void 0===a||a.push(n)},removeEdge:function(t,n){var a;null===(a=e.edgeMap.get(t))||void 0===a||a.remove(n)},getEdgeTag:function(t){return e.edgeMap.get(t)}}}))},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return m.i.compose.apply(m.i,Object(s.a)([m.i.model({id:m.i.identifier})].concat(e))).named("Node")},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m.i.model("Graph",Object.fromEntries(Object.keys(e).map((function(t){var n=e[t];if(Object(m.f)(n)&&Object(m.e)(n.properties.id))return[t,m.i.map(e[t])];throw Error("Model '".concat(t,"' requires 'id' identifier"))})))).actions((function(n){return{createNode:function(){var a,o,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Node",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e[r])throw Error("No model named '".concat(r,"'"));var c=e[r].create(Object(u.a)({id:null!==(a=null===(o=t.getId)||void 0===o?void 0:o.call(t))&&void 0!==a?a:Object(f.a)()},i));return n[r].put(c),c}}}))},b=g(p((function(){return b}))),h=(v({Node:b}),n(17)),E=n(29),y=n(81),j=m.i.union(m.i.null,m.i.boolean,m.i.string,m.i.number,m.i.array(m.i.late((function(){return j}))),m.i.map(m.i.late((function(){return j})))),k=g([p((function(){return m.i.union(m.i.late((function(){return k})),S)}))]).props({content:m.i.union(m.i.string,j)}).actions((function(e){return{setContent:function(t){e.content=t},graphRoot:function(){return Object(m.c)(e,M)},getConfig:function(t){var n,a;if(e.edgeMap.size&&(null===(n=e.edgeMap.get("config"))||void 0===n?void 0:n.length))return null===(a=e.edgeMap.get("config"))||void 0===a?void 0:a[0];if(t){var o=e.graphRoot().createNode("ViewerConfig",{});return e.addEdge("config",o),o}}}})).views((function(e){return{get childCount(){var t,n;return null!==(t=null===(n=e.edgeMap.get("child"))||void 0===n?void 0:n.length)&&void 0!==t?t:0}}})),N=m.i.model("Config",{name:m.i.maybe(m.i.string),items:m.i.map(j)}).actions((function(e){return{set:function(t,n){e.items.set(t,n)},get:function(t){return e.items.get(t)}}})),O=g(N),C=n(25),w=m.i.model("ViewerConfigItem",{expanded:m.i.optional(m.i.boolean,!1)}).actions((function(e){return{setExpanded:function(t){e.expanded=t}}})),x=m.i.model("ViewerConfig",{items:m.i.map(m.i.map(w))}).actions((function(e){return{getItem:function(t,n,a){var o,r=null===(o=e.items.get(t))||void 0===o?void 0:o.get(n);return console.log("wtf",e.items.size),e.items.size>=0&&!r&&a&&(r=w.create(),e.items.set(t,Object(C.a)({},n,r))),r}}})),S=g(x),M=v({Node:k,Config:O,ViewerConfig:S}).actions((function(e){return{setActiveMode:function(t){var n=e.activeModes;(null===n||void 0===n?void 0:n.includes(t))||(n.push(t),"select"===t&&n.remove("edit"),"edit"===t&&(n.remove("select"),e.clearSelectedNodes()))},unsetActiveMode:function(t){var n=e.activeModes;(null===n||void 0===n?void 0:n.includes(t))&&n.remove(t)},toggleActiveMode:function(t){var n=e.activeModes;n&&(n.includes(t)?(n.remove(t),"select"===t&&e.clearSelectedNodes()):(n.push(t),"select"===t&&n.remove("edit"),"edit"===t&&(n.remove("select"),e.clearSelectedNodes())))}}})).actions((function(e){return{toggleSelectNode:function(t,n){var a=e.Config.get("system").get("selectedNodes");if(a){var o=a.get(n.id);o?o.includes(t.id)?(o.remove(t.id),0===o.length&&a.delete(n.id)):o.push(t.id):a.set(n.id,[t.id])}},clearSelectedNodes:function(){var t;null===(t=e.Config.get("system").get("selectedNodes"))||void 0===t||t.clear(),0===e.selectedNodes.size&&e.unsetActiveMode("select")},deleteSelectedNodes:function(){e.selectedNodes.forEach((function(t){return t.forEach((function(t){return e.Node.delete(t)}))})),e.clearSelectedNodes()},moveSelectedNodes:function(t){var n,a=Object(E.a)(e.selectedNodes);try{for(a.s();!(n=a.n()).done;){var o,r=Object(h.a)(n.value,2),i=r[0],c=r[1],l=e.Node.get(i),d=Object(E.a)(c);try{for(d.s();!(o=d.n()).done;){var u=o.value,s=e.Node.get(u);s&&(s.removeEdge("parent",l),l.removeEdge("child",s),s.addEdge("parent",t),t.addEdge("child",s))}}catch(m){d.e(m)}finally{d.f()}}}catch(m){a.e(m)}finally{a.f()}e.clearSelectedNodes()},copySelectedNodes:function(){},linkSelectedNodes:function(t){var n,a=Object(E.a)(e.selectedNodes.values());try{for(a.s();!(n=a.n()).done;){var o,r=n.value,i=Object(E.a)(r);try{for(i.s();!(o=i.n()).done;){var c=o.value,l=e.Node.get(c);l&&(l.addEdge("parent",t),t.addEdge("child",l))}}catch(d){i.e(d)}finally{i.f()}}}catch(d){a.e(d)}finally{a.f()}e.clearSelectedNodes()},unlinkSelectedNodes:function(){var t,n=Object(E.a)(e.selectedNodes);try{for(n.s();!(t=n.n()).done;){var a,o=Object(h.a)(t.value,2),r=o[0],i=o[1],c=e.Node.get(r),l=Object(E.a)(i);try{for(l.s();!(a=l.n()).done;){var d=a.value,u=e.Node.get(d);u&&(u.removeEdge("parent",c),c.removeEdge("child",u))}}catch(s){l.e(s)}finally{l.f()}}}catch(s){n.e(s)}finally{n.f()}e.clearSelectedNodes()},removeSelectedNodes:function(){var t,n=Object(E.a)(e.selectedNodes);try{for(n.s();!(t=n.n()).done;){var a,o=Object(h.a)(t.value,2),r=o[0],i=o[1],c=e.Node.get(r),l=Object(E.a)(i);try{for(l.s();!(a=l.n()).done;){var d=a.value,u=e.Node.get(d);u&&(u.removeEdge("parent",c),c.removeEdge("child",u),0===u.edgeMap.get("parent").size&&e.deleteNode(u))}}catch(s){l.e(s)}finally{l.f()}}}catch(s){n.e(s)}finally{n.f()}e.clearSelectedNodes()}}})).actions((function(e){return{afterCreate:function(){Object(y.a)(e).catch((function(e){console.error("Persist error",e)})).then((function(){if(!e.rootNode){var t=e.createNode("Node",{content:"Exuo"});Object(m.a)(e.Config,{system:{id:"system",items:{rootNodeId:t.id,selectedNodes:{},activeModes:[]}}})}}))},createChild:function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Node",o=e.createNode(a,n);return t.addEdge("child",o),o.addEdge("parent",t),o},deleteNode:function(t){e.Node.delete(t.id)}}})).views((function(e){return{get rootNode(){var t=e.Config.get("system");return e.Node.get(null===t||void 0===t?void 0:t.get("rootNodeId"))},get activeModes(){var t=e.Config.get("system");return null===t||void 0===t?void 0:t.get("activeModes")},get selectedNodes(){var t=e.Config.get("system");return null===t||void 0===t?void 0:t.get("selectedNodes")},get selectedNodeCount(){var t,n=0,a=Object(E.a)(e.selectedNodes);try{for(a.s();!(t=a.n()).done;){n+=t.value[1].length}}catch(o){a.e(o)}finally{a.f()}return n}}})),B=n(333),T=n(329),A=n(349),I=n(308),R=n(336),F=n(337),L=n(304),z=n(340),P=n(169),D=n.n(P),W=n(168),U=n.n(W),K=n(18),G=n(31),V=n(23),q=m.i.model("Note",{content:m.i.maybe(j)}).actions((function(e){return{setContent:function(t){e.content=t}}})),J=(g(q),n(332)),H=n(338),X=n(350),Y=n(339),$=n(331),Q=n(163),Z=n.n(Q),_=n(162),ee=n.n(_),te=n(164),ne=n.n(te),ae=n(165),oe=n.n(ae),re=n(166),ie=n.n(re),ce=n(167),le=n.n(ce),de=n(160),ue=n.n(de),se=n(161),me=n.n(se),fe=n(20),pe=(n(298),[{label:"UL",style:"unordered-list-item",icon:o.a.createElement(ue.a,null)},{label:"OL",style:"ordered-list-item",icon:o.a.createElement(me.a,null)},{label:"Blockquote",style:"blockquote",icon:o.a.createElement(ee.a,null)},{label:"Code Block",style:"code-block",icon:o.a.createElement(Z.a,null)}]),ge=[{label:"Bold",style:"BOLD",icon:o.a.createElement(ne.a,null)},{label:"Italic",style:"ITALIC",icon:o.a.createElement(oe.a,null)},{label:"Underline",style:"UNDERLINE",icon:o.a.createElement(ie.a,null)},{label:"Monospace",style:"CODE",icon:o.a.createElement(le.a,null)}],ve=function(e){switch(e.getType()){case"blockquote":return"RichEditor-blockquote";default:return""}},be=function(e){var t=e.onToggle,n=e.style,a=e.active,r=e.label,i=e.icon,c=function(e){e.preventDefault(),t(n)},l="RichEditor-styleButton";return a&&(l+=" RichEditor-activeButton"),i?o.a.createElement(J.a,{size:"small",onMouseDown:c,className:l},i):o.a.createElement(L.a,{size:"small",startIcon:i||void 0,onMouseDown:c,className:l},i?"":r)},he=function(e){var t=e.editorState,n=e.onToggle,a=t.getSelection(),r=t.getCurrentContent().getBlockForKey(a.getStartKey()).getType();return o.a.createElement("div",null,pe.map((function(e){return o.a.createElement(be,{key:e.label,active:e.style===r,label:e.label,icon:e.icon,onToggle:n,style:e.style})})))},Ee=function(e){var t=e.editorState,n=e.onToggle,a=t.getCurrentInlineStyle();return o.a.createElement("div",null,ge.map((function(e){return o.a.createElement(be,{key:e.label,active:a.has(e.style),label:e.label,icon:e.icon,onToggle:n,style:e.style})})))},ye=Object(T.a)((function(e){return Object(A.a)({root:{width:"100%",zIndex:e.zIndex.appBar+10},backdrop:{cursor:"default",backdropFilter:"blur(3px) saturate(0%)",backgroundColor:Object(K.c)(e.palette.background.default,.8)},wrapper:{outline:"none",background:"\n        linear-gradient(\n          to top,\n          ".concat(Object(K.c)(e.palette.background.default,0),",\n          ").concat(Object(K.c)(e.palette.background.default,1),"             ").concat(e.spacing(1)/2,"px calc(100% - ").concat(e.spacing(1)/2,"px),\n          ").concat(Object(K.c)(e.palette.background.default,0),"\n        ),\n        linear-gradient(\n          to right,\n          ").concat(e.palette.primary.main,",\n          ").concat(e.palette.secondary.main," \n        )\n      "),"& .DraftEditor-editorContainer":{maxHeight:"70vh",overflowY:"auto",border:0,padding:e.spacing(1,2,1,2),"& [data-contents=true] > [data-block=true]":Object(u.a)(Object(u.a)({},e.typography.body2),{},{"&:first-child":Object(u.a)({},e.typography.body1)})}},toolbar:{justifyContent:"center",background:"\n        linear-gradient(\n          to bottom,\n          ".concat(e.palette.background.default," 30%,\n          ").concat(Object(K.c)(e.palette.background.default,0),"\n        )\n      "),"&>div:first-child":{marginRight:e.spacing(4)}}})})),je=o.a.forwardRef((function(e,t){var n=e.note,a=e.text,r=e.rawContent,i=e.placeholder,c=e.autoFocus,l=e.showBackdrop,d=e.showControls,u=e.showRichTextControls,s=e.className,m=e.inputClassName,f=e.onValue,p=e.onClickAway,g=e.onEscape,v=ye(),b=o.a.useRef(null),y=o.a.useRef(null),j=null===n||void 0===n?void 0:n.nodeContent,k=o.a.useMemo((function(){return j&&Object(fe.convertFromRaw)(JSON.parse(j))||r&&Object(fe.convertFromRaw)(r)}),[j,r]),N=o.a.useState((function(){var e;return fe.EditorState.createWithContent(k||fe.ContentState.createFromText(null!==(e=null!==a&&void 0!==a?a:null===n||void 0===n?void 0:n.content)&&void 0!==e?e:""))})),O=Object(h.a)(N,2),C=O[0],w=O[1],x=Object(H.a)("(pointer: coarse) and (hover: none)"),S=o.a.useState(!x),M=Object(h.a)(S,2),B=M[0],T=M[1];o.a.useEffect((function(){c&&w(fe.EditorState.moveFocusToEnd(C))}),[]);var A=function(e){var t=C.getCurrentContent(),a=Object(fe.convertToRaw)(t);n&&(n.setRawContentState(a),n.setContent(t.getFirstBlock().getText())),(null===f||void 0===f?void 0:f(n||function(e){if("string"===typeof e)return!0;var t,n=Object(E.a)(e.blocks);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.depth||"unstyled"!==a.type||a.inlineStyleRanges.length)return!1}}catch(o){n.e(o)}finally{n.f()}return!0}(a)?t.getPlainText():a,e))&&w(fe.EditorState.forceSelection(fe.EditorState.push(fe.EditorState.moveFocusToEnd(C),fe.ContentState.createFromText(""),"remove-range"),t.getSelectionAfter()))},I=C.getCurrentContent().getBlocksAsArray().length;return o.a.createElement("div",{ref:t,className:[v.root,s].join(" ")},I>1&&l&&o.a.createElement(X.a,{open:Boolean(l),className:v.backdrop}),o.a.createElement(Y.a,{mouseEvent:"onMouseDown",touchEvent:"onTouchStart",onClickAway:function(e){p?p():A(e)}},o.a.createElement("div",{ref:b},o.a.createElement("div",{tabIndex:-1,className:[v.wrapper,m].join(" ")},o.a.createElement(fe.Editor,{ref:y,blockStyleFn:ve,editorState:C,handleKeyCommand:function(e,t){var n=fe.RichUtils.handleKeyCommand(t,e);return n?(w(n),"handled"):"not-handled"},keyBindingFn:function(e){return 13===e.keyCode?B&&!e.shiftKey||!B&&e.shiftKey?(A(),null):(T(!1),Object(fe.getDefaultKeyBinding)(e)):27===e.keyCode?(null===g||void 0===g||g(),null):Object(fe.getDefaultKeyBinding)(e)},onChange:w,placeholder:i,spellCheck:!0})),I>1&&d&&o.a.createElement($.a,{variant:"dense",className:v.toolbar},u&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ee,{editorState:C,onToggle:function(e){w(fe.RichUtils.toggleInlineStyle(C,e))}}),o.a.createElement(he,{editorState:C,onToggle:function(e){w(fe.RichUtils.toggleBlockType(C,e))}}))))))}));je.defaultProps={showBackdrop:!0,showControls:!0,showRichTextControls:!0};var ke=Object(T.a)((function(e){return Object(A.a)({itemContainer:{"&.isExpanded":{}},listItem:{position:"relative",cursor:"pointer",transition:e.transitions.create(["color","background"],{duration:e.transitions.duration.shortest}),"&:hover":{color:e.palette.primary.main,backgroundColor:e.palette.background.paper},"&.editMode":{cursor:"default",color:"unset"},"&.selectMode":{cursor:"default",color:"unset"},"&.isEditing, &.isEditing + li":{borderColor:"transparent"},"&.Mui-selected":{background:"\n          linear-gradient(\n            to top,\n            ".concat(Object(K.c)(e.palette.background.default,0),",\n            ").concat(Object(K.c)(e.palette.background.default,.9),"               ").concat(e.spacing(1)/2,"px calc(100% - ").concat(e.spacing(1)/2,"px),\n            ").concat(Object(K.c)(e.palette.background.default,0),"\n          ),\n          linear-gradient(\n            to right,\n            ").concat(e.palette.primary.main,",\n            ").concat(e.palette.secondary.main," \n          )\n        "),"&:hover":{color:"unset"},"& a:hover":{color:"unset"}}},childList:{marginLeft:e.spacing(3),padding:0},itemText:{margin:0,overflowX:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",".isEditing &":{opacity:0},"& .MuiListItemText-primary":{display:"inline"},"& .MuiListItemText-secondary":{display:"inline",paddingLeft:e.spacing(1)},"&.expand":{"& .MuiListItemText-secondary":{display:"block",paddingLeft:0}}},listItemSelectCheckbox:{padding:e.spacing(0,1,0,1),"&:hover, &.Mui-checked:hover":{backgroundColor:"unset"}},listItemIcon:{minWidth:"auto"},noteEditor:{cursor:"default",position:"absolute",top:0,left:0},noteEditorInput:{cursor:"text"},secondaryActions:{right:0},childButton:{cursor:"pointer",color:e.palette.text.primary,transition:e.transitions.create(["color"],{duration:e.transitions.duration.shortest}),minWidth:"unset",paddingRight:e.spacing(2),paddingLeft:e.spacing(2),"&:hover, &:focus":{color:e.palette.primary.main,background:"inherit"}}})})),Ne=function(e){var t=e.node,n=e.parentNode,a=e.expandSecondaryTypography,r=(e.expanded,e.className),c=ke(),l=Object(G.c)(),u=d(),s=o.a.useState(!1),m=Object(h.a)(s,2),f=m[0],p=m[1];return i((function(e){var i,d,s,m,g,v=null===u||void 0===u?void 0:u.getConfig(),b=null!==(i=null===v||void 0===v||null===(d=v.getItem(n.id,t.id))||void 0===d?void 0:d.expanded)&&void 0!==i&&i,h=null===(s=e.selectedNodes.get(n.id))||void 0===s?void 0:s.includes(t.id),E=t.id,y=void 0,j=null===(m=t.content)||void 0===m||null===(g=m.toJSON)||void 0===g?void 0:g.call(m);if("string"===typeof t.content){var k=t.content.indexOf("\n");E=k>0?t.content.slice(0,k):t.content,y=k>0?t.content.slice(k+1):void 0}else if(j){var N;E=j.blocks[0].text,y=null===(N=j.blocks[1])||void 0===N?void 0:N.text}return o.a.createElement(o.a.Fragment,null,o.a.createElement(I.a,{onClick:function(a){a.preventDefault(),a.altKey?(p(!0),e.setActiveMode("edit")):a.shiftKey?(p(!1),e.setActiveMode("select"),e.toggleSelectNode(t,n)):e.activeModes.includes("select")?e.toggleSelectNode(t,n):e.activeModes.includes("edit")?p(!0):l(Object(V.b)("/node/".concat(t.id,"/")))},selected:h,component:"li",ContainerProps:{className:[c.itemContainer,t.childCount>0&&b?"isExpanded":"",r].join(" ")},className:[c.listItem,e.activeModes.includes("edit")?"editMode":"",e.activeModes.includes("select")?"selectMode":"",f?"isEditing":""].join(" ")},f&&o.a.createElement(je,{autoFocus:!0,text:j?void 0:t.content,rawContent:j,className:c.noteEditor,inputClassName:c.noteEditorInput,onValue:function(e){p(!1),e&&("string"===typeof e||Object.keys(e).includes("blocks"))&&t.setContent(e)},onEscape:function(){p(!1),e.unsetActiveMode("edit")}}),o.a.createElement(R.a,{primary:E,secondary:y,className:[c.itemText,a?"expand":""].join(" ")}),!f&&o.a.createElement(F.a,{className:c.secondaryActions},(t.childCount>0||e.activeModes.includes("select")||e.activeModes.includes("edit"))&&o.a.createElement(L.a,{to:Object(V.b)("/node/".concat(t.id,"/")),component:G.a,onClick:function(e){e.preventDefault(),function(){var e,a=null===u||void 0===u||null===(e=u.getConfig(!0))||void 0===e?void 0:e.getItem(n.id,t.id,!0);a.setExpanded(!a.expanded)}()},className:c.childButton,endIcon:t.childCount>0&&b?o.a.createElement(U.a,null):o.a.createElement(D.a,null),size:"small"},t.childCount>0&&t.childCount))),t.childCount>0&&o.a.createElement(z.a,{in:b,timeout:"auto",unmountOnExit:!0},o.a.createElement(Ce,{inner:!0,node:t,edgeTag:"child",className:c.childList})))}))};Ne.defaultProps={expandSecondaryTypography:!0};var Oe=Object(T.a)((function(e){return Object(A.a)({list:{padding:0,"&>li":{borderTop:".01px solid ".concat(e.palette.divider),"&:first-child":{borderTop:"unset"}},borderBottom:".01px solid ".concat(e.palette.divider),"&.inner":{borderTop:".01px solid ".concat(e.palette.divider),borderBottom:"unset"}}})})),Ce=function(e){var t=e.node,n=e.edgeTag,a=e.inner,r=e.className,c=Oe();return i((function(e){var i=t.edgeMap.get(n);return(null===i||void 0===i?void 0:i.length)?o.a.createElement(B.a,{"aria-label":"edge list",className:[c.list,a?"inner":"",r].join(" ")},null===i||void 0===i?void 0:i.map((function(e){return o.a.createElement(Ne,{node:e,parentNode:t,key:"".concat(t.id,"-").concat(n,"-").concat(e.id)})}))):null}))},we=(n(345),Object(T.a)((function(e){return Object(A.a)({root:Object(u.a)({display:"inline-block",margin:0,padding:e.spacing(1,2,1,2),overflowX:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},e.typography.body1)})})),n(307)),xe=n(179),Se=n.n(xe),Me=n(178),Be=n.n(Me),Te=n(177),Ae=n.n(Te),Ie=n(180),Re=n.n(Ie),Fe=n(90),Le=n(348),ze=n(302),Pe=n(351),De=n(341),We=n(172),Ue=n.n(We),Ke=n(173),Ge=n.n(Ke),Ve=n(176),qe=n.n(Ve),Je=n(175),He=n.n(Je),Xe=n(174),Ye=n.n(Xe),$e=n(170),Qe=n.n($e),Ze=Object(T.a)((function(e){return Object(A.a)({root:{display:"inherit",position:"relative"},buttonGroup:{"& .MuiButtonGroup-groupedTextHorizontal":{borderRight:"unset"},"& .MuiButtonGroup-grouped":{minWidth:"unset"}},selectCount:{color:e.palette.primary.main,fontSize:12,position:"absolute",right:-e.spacing(1)},selectButton:{},deleteButton:{color:e.palette.error.main},popper:{"& svg":{marginRight:e.spacing(1)}},paper:{border:".01px solid ".concat(e.palette.divider)},selectMenu:{outline:0}})})),_e=function(e){e.node;var t=e.className,n=e.onClick,a=Object(Fe.a)(e,["node","className","onClick"]),r=Ze(),c=o.a.useState(!1),l=Object(h.a)(c,2),u=l[0],s=l[1],m=o.a.useRef(null),f=d();return i((function(e){var i=e.selectedNodeCount;return o.a.createElement("div",{className:[r.root,t].join(" ")},i>0&&o.a.createElement("span",{className:r.selectCount},i),o.a.createElement(J.a,Object.assign({color:"primary",ref:m,onClick:e.selectedNodes.size?function(){return s((function(e){return!e}))}:n,className:r.selectButton},a),o.a.createElement(Qe.a,null)),o.a.createElement(Le.a,{open:u,anchorEl:m.current,role:void 0,disablePortal:!0,className:r.popper},(function(t){t.placement;return o.a.createElement(Y.a,{onClickAway:function(e){e.preventDefault(),s(!1)}},o.a.createElement(ze.a,{elevation:0,className:r.paper},o.a.createElement(Pe.a,{dense:!0,className:r.selectMenu},o.a.createElement(De.a,{divider:!0,onClick:function(){e.removeSelectedNodes(),s(!1)},className:r.deleteButton},o.a.createElement(Ue.a,null),"Remove"),o.a.createElement(De.a,{onClick:function(){e.linkSelectedNodes(f),s(!1)}},o.a.createElement(Ge.a,null),"Link here"),o.a.createElement(De.a,{disabled:!0,onClick:function(){s(!1)}},o.a.createElement(Ye.a,null),"Copy here"),o.a.createElement(De.a,{divider:!0,onClick:function(){e.moveSelectedNodes(f),s(!1)}},o.a.createElement(He.a,null),"Move here"),o.a.createElement(De.a,{onClick:function(){e.clearSelectedNodes(),s(!1)}},o.a.createElement(qe.a,null),"Clear selection"))))})))}))},et=Object(T.a)((function(e){var t;return Object(A.a)({root:{},toolbar:(t={justifyContent:"space-evenly"},Object(C.a)(t,e.breakpoints.up("sm"),{justifyContent:"center"}),Object(C.a)(t,"minHeight",e.spacing(8)),Object(C.a)(t,"backdropFilter","blur(3px)"),Object(C.a)(t,"background","\n        linear-gradient(\n          to bottom,\n          ".concat(Object(K.c)(e.palette.background.default,.9),",\n          ").concat(Object(K.c)(e.palette.background.default,1)," 90%\n        )")),t),insertButton:{color:e.palette.background.default,boxShadow:"unset",margin:e.spacing(0,1,0,1),background:"\n        radial-gradient(\n          circle at bottom,\n          ".concat(e.palette.secondary.main,",\n          ").concat(e.palette.primary.main," 75%\n        )"),"&:hover, &:focus":{boxShadow:"unset",background:"\n        radial-gradient(\n          circle at bottom,\n          ".concat(Object(K.b)(e.palette.secondary.main,.3),",\n          ").concat(e.palette.primary.main," 75%\n        )")},"&:active":{boxShadow:"unset",background:"\n        radial-gradient(\n          circle at bottom,\n          ".concat(Object(K.b)(e.palette.secondary.main,.3),",\n          ").concat(e.palette.primary.main," 75%\n        )")}}})})),tt=function(e){var t=e.node,n=e.className,a=et();return i((function(e){var r,i=t.childCount>0,c=null!==(r=e.selectedNodes.size)&&void 0!==r?r:0;return o.a.createElement(we.a,{className:[a.root,n].join(" ")},o.a.createElement($.a,{className:a.toolbar},o.a.createElement(J.a,{disabled:!0,color:e.activeModes.includes("edit")?"primary":void 0,onClick:function(){return e.toggleActiveMode("edit")}},o.a.createElement(Ae.a,null)),o.a.createElement(J.a,{disabled:!i,color:e.activeModes.includes("edit")?"primary":void 0,onClick:function(){return e.toggleActiveMode("edit")}},o.a.createElement(Be.a,null)),o.a.createElement(J.a,{color:"primary",onClick:function(){e.setActiveMode("insert")},className:a.insertButton},o.a.createElement(Se.a,null)),o.a.createElement(_e,{disabled:!(i||c>0),node:t,color:e.activeModes.includes("select")?"primary":void 0,onClick:function(){e.toggleActiveMode("select")}}),o.a.createElement(J.a,{disabled:!0,color:e.activeModes.includes("edit")?"primary":void 0,onClick:function(){return e.toggleActiveMode("edit")}},o.a.createElement(Re.a,null)),!1))}))},nt=n(330),at=n(57),ot=Object(T.a)((function(e){return Object(A.a)({root:{textAlign:"center",position:"relative",paddingBottom:e.spacing(8)},appBar:{position:"sticky",borderBottom:".01px solid ".concat(e.palette.divider),backdropFilter:"blur(3px)",background:"\n        linear-gradient(\n          to top,\n          ".concat(Object(K.c)(e.palette.background.default,.9),",\n          ").concat(Object(K.c)(e.palette.background.default,1)," 90%\n        )")},titleBar:{background:"unset"},children:{},textEditor:{position:"sticky",bottom:0},actions:Object(C.a)({borderTop:".01px solid ".concat(e.palette.divider),zIndex:e.zIndex.appBar,position:"fixed",bottom:0,left:"50%",width:"100%",transform:"translateX(-50%)"},e.breakpoints.up("sm"),{maxWidth:"900px"})})})),rt=function(e){var t=e.node,n=e.className,a=e.children,r=ot(),c=Object(G.c)();return i((function(e){var i,l,d,u=null===(i=t.content)||void 0===i||null===(l=i.toJSON)||void 0===l?void 0:l.call(i);if("string"===typeof t.content)d=t.content;else if(u){var s,m;d=null===(s=u.blocks)||void 0===s||null===(m=s[0])||void 0===m?void 0:m.text}else d=t.id;return o.a.createElement(we.a,{className:[r.root,n].join(" ")},o.a.createElement(nt.a,{elevation:0,className:r.appBar},o.a.createElement(at.c,{title:d,className:r.titleBar})),o.a.createElement(we.a,{className:[r.children,e.activeModes.includes("insert")?"fade":""].join(" ")},a),e.activeModes.includes("insert")&&o.a.createElement(je,{autoFocus:!0,className:r.textEditor,onValue:function(n,a){if(n){var o=e.createChild(t,{content:n});if(!(null===a||void 0===a?void 0:a.ctrlKey))return!0;c(Object(V.b)("/node/".concat(o.id,"/")))}else e.toggleActiveMode("insert")},onEscape:function(){e.unsetActiveMode("insert")}}),o.a.createElement(tt,{node:t,className:[r.actions,e.activeModes.includes("insert")?"fade":""].join(" ")}))}))},it=function(e){var t=e.id;return i((function(e){var n=e.Node.get(t),a=null!==n&&void 0!==n?n:e.rootNode;return a?o.a.createElement(l,{value:a},o.a.createElement(rt,{node:a},o.a.createElement(Ce,{node:a,edgeTag:"child"}))):null}))}},23:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return m}));var a=n(90),o=n(0),r=n.n(o),i=n(31),c=n(19),l=n(152),d=n(57);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"/exuo"+e}var s=function(e){var t=e.component,n=Object(a.a)(e,["component"]);return r.a.createElement(t,n)},m=function(){return Object(c.k)((function(e){return e.rootNode?r.a.createElement(i.b,{basepath:"/exuo"},r.a.createElement(s,{path:"/",component:c.f}),r.a.createElement(s,{path:":type/:id",component:c.f}),r.a.createElement(s,{path:"peer/:id",component:l.PeerConnector}),r.a.createElement(s,{path:"settings",component:d.b})):null}))}},299:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(15),i=n.n(r),c=(n(193),n(89)),l=n(342),d=n(18),u=n(343),s=n(338),m=n(344),f=function(e){var t=e.children,n=Object(s.a)("(prefers-color-scheme: dark)"),a=o.a.useMemo((function(){var e={type:n?"dark":"light",primary:{main:"#FF2EA2"},secondary:{main:"#FF8F00"},divider:n?"#222222":"#e0e0e0",background:{default:n?"#000000":"#ffffff",paper:n?"#101010":"#fbfbfb"},text:{primary:n?"#dddddd":"#212121",secondary:n?"#aaaaaa":"#595959"}};return Object(l.a)({typography:{fontSize:16,fontFamily:["-apple-system","system-ui","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif"].join(", ")},palette:e,shape:{borderRadius:6},props:{MuiButton:{disableElevation:!0},MuiButtonGroup:{disableElevation:!0}},overrides:{MuiButtonBase:{root:{cursor:"default"}},MuiCssBaseline:{"@global":{"*::selection":{backgroundColor:Object(d.c)(e.primary.main,.2)},html:{userSelect:"none",overscrollBehavior:"none","-webkit-touch-callout":"none",maxWidth:"900px",margin:"auto","&, & body":{height:"100%"}}}}}})}),[n]);return o.a.createElement(u.a,{theme:a},o.a.createElement(m.a,null),t)},p=n(23),g=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function v(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(c.a,null,o.a.createElement(f,null,o.a.createElement(p.a,null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/exuo",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/exuo","/service-worker.js");g?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):v(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):v(t,e)}))}}()},57:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return L})),n.d(t,"d",(function(){return z}));var a=n(0),o=n.n(a),r=n(307),i=n(330),c=n(329),l=n(349),d=Object(c.a)((function(e){return Object(l.a)({root:{},appBar:{},actions:{width:"100%",color:e.palette.text.secondary,backgroundColor:e.palette.background.default,padding:e.spacing(0,2,0,2)},children:{}})})),u=function(e){var t=e.title,n=e.actions,a=e.className,c=e.children,l=d();return o.a.createElement(r.a,{className:[l.root,a].join(" ")},o.a.createElement(i.a,{elevation:0,position:"sticky",className:l.appBar},o.a.createElement(j,{title:t}),n),o.a.createElement(r.a,{className:l.children},c))},s=n(331),m=n(332),f=n(61),p=n(156),g=n.n(p),v=n(157),b=n.n(v),h=n(31),E=n(23),y=Object(c.a)((function(e){return Object(l.a)({root:{color:e.palette.text.secondary,backgroundColor:e.palette.background.default,padding:e.spacing(0,2,0,2)},backButton:{cursor:"pointer","&[disabled]":{visibility:"hidden",pointerEvents:"none"}},hide:{visibility:"hidden",mouseEvents:"none"},settingsButton:{},title:{flexGrow:1,textAlign:"center",overflowX:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",color:e.palette.text.primary}})})),j=function(e){var t,n=e.title,a=e.showBackButton,r=e.showSettingsButton,i=e.className,c=(e.children,y()),l=null!==(t=null===n||void 0===n?void 0:n.indexOf("\n"))&&void 0!==t?t:-1;return o.a.createElement(s.a,{className:[c.root,i].join(" ")},o.a.createElement(m.a,{disabled:z(),edge:"start","aria-label":"back",onClick:function(){return window.history.back()},className:[c.backButton,a?"":c.hide].join(" ")},o.a.createElement(g.a,null)),n&&o.a.createElement(f.a,{variant:"h6",component:"h1",className:c.title},l>0?n.slice(0,n.indexOf("\n")):n),o.a.createElement(m.a,{disabled:!0,edge:"end",component:h.a,to:Object(E.b)("/settings"),"aria-label":"settings",className:[c.settingsButton,r?"":c.hide].join(" ")},o.a.createElement(b.a,{fontSize:"small"})))};j.defaultProps={title:"Exuo",showBackButton:!0,showSettingsButton:!1};var k=n(333),N=n(334),O=n(308),C=n(335),w=n(336),x=n(337),S=n(347),M=n(158),B=n.n(M),T=n(102),A=n.n(T),I=n(159),R=n.n(I),F=n(19),L=function(){return Object(F.k)((function(e){var t;return o.a.createElement(u,null,o.a.createElement(k.a,{subheader:o.a.createElement(N.a,null,"Global")},o.a.createElement(O.a,null,o.a.createElement(C.a,null,o.a.createElement(A.a,null)),o.a.createElement(w.a,{id:"switch-list-label-dividers",primary:"Dividers"}),o.a.createElement(x.a,null,o.a.createElement(S.a,{disabled:!0,edge:"end",inputProps:{"aria-labelledby":"switch-list-label-list-dividers"}})))),o.a.createElement(k.a,{subheader:o.a.createElement(N.a,null,"Lists")},o.a.createElement(O.a,null,o.a.createElement(C.a,null,o.a.createElement(B.a,null)),o.a.createElement(w.a,{id:"switch-list-label-checkboxes",primary:"Checkboxes"}),o.a.createElement(x.a,null,o.a.createElement(S.a,{checked:null!==(t=e.listCheckboxSetting)&&void 0!==t&&t,onChange:function(){return e.toggleListCheckboxSetting()},edge:"end",inputProps:{"aria-labelledby":"switch-list-label-list-checkboxes"}}))),o.a.createElement(O.a,null,o.a.createElement(C.a,null,o.a.createElement(A.a,null)),o.a.createElement(w.a,{id:"switch-list-label-dividers",primary:"Dividers"}),o.a.createElement(x.a,null,o.a.createElement(S.a,{disabled:!0,edge:"end",inputProps:{"aria-labelledby":"switch-list-label-list-dividers"}}))),o.a.createElement(O.a,null,o.a.createElement(C.a,null,o.a.createElement(R.a,null)),o.a.createElement(w.a,{id:"switch-list-label-bluetooth",primary:"Show Extra Edge Types"}),o.a.createElement(x.a,null,o.a.createElement(S.a,{disabled:!0,edge:"end",inputProps:{"aria-labelledby":"switch-list-label-bluetooth"}})))))}))},z=function(){return window.location.pathname===Object(E.b)("/")||window.location.pathname===Object(E.b)()}},81:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(101),o=n.n(a),r=n(25),i=n(17),c=n(149),l=n(4),d=n(150);function u(e){return s.apply(this,arguments)}function s(){return(s=Object(c.a)(o.a.mark((function e(t){var n,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new d.a("default"),a=Object.keys(Object(l.b)(t).properties),c=Object.fromEntries(a.map((function(e){return[e,"id"]}))),n.version(1).stores(c),e.abrupt("return",Promise.all(a.map((function(e){return n.table(e).toArray().then((function(t){return[e,Object.fromEntries(t.map((function(e){return[e.id,e]})))]}))}))).then((function(e){Object(l.a)(t,Object.fromEntries(e));var a,o=[];Object(l.h)(t,(function(e){o.push(e),a&&clearTimeout(a),a=setTimeout((function(){o.forEach((function(e){var a=e.path.split("/").slice(1),o=Object(i.a)(a,3),c=o[0],d=o[1],u=o[2];if("add"===e.op)n.table(c).put(Object(l.d)(t[c].get(d)));else{if("replace"!==e.op&&"remove"!==e.op)throw Error("Unknown patch op '".concat(e.op,"'"));if(u){var s=t[c].get(d)[u];Object(l.g)(s)&&(s=Object(l.d)(s)),n.table(c).update(d,Object(r.a)({},u,s))}else n.table(c).delete(d)}})),o=[]}),1e3)}))})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},89:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return f}));var a=n(0),o=n.n(a),r=n(19),i=(n(333),n(308),n(336),n(329)),c=n(349),l=n(4),d=(Object(i.a)((function(e){return Object(c.a)({root:{},item:{},itemText:{}})})),l.i.model("Store",{graph:r.c,location:l.i.optional(l.i.string,"/")}).actions((function(e){return{setLocation:function(t){e.location=t}}})).create({graph:r.c.create()})),u=o.a.createContext(d),s=function(e){var t=e.children;return o.a.createElement(u.Provider,{value:d},t)},m=n(181);function f(e){var t=o.a.useContext(u);if(t)return Object(m.a)((function(){return e(t)}));throw Error("Cannot use store before setup")}n(81)}},[[188,1,2]]]);
//# sourceMappingURL=main.f557f004.chunk.js.map