{"version":3,"sources":["serviceWorker.ts","graph/persist.ts","graph/models/Config.ts","graph/models/Log.ts","graph/factories.ts","graph/models/Node.ts","graph/setup.ts","graph/models/Graph.ts","theme.tsx","components/PropertyEditor.tsx","components/Header.tsx","components/NodeActions.tsx","components/AddItem.tsx","components/NodeListItem.tsx","components/EdgeList.tsx","components/NodeViewer.tsx","components/Settings.tsx","components/Router.tsx","index.tsx"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","graph","a","db","Dexie","tableNames","Object","keys","getMembers","properties","tableConfig","fromEntries","map","name","version","stores","Promise","all","table","toArray","rows","r","id","resolved","applySnapshot","onPatch","patch","path","split","slice","typeName","propName","op","put","getSnapshot","get","Error","update","delete","persist","Basic","t","union","boolean","string","number","array","late","Config","model","maybe","items","actions","self","set","key","value","views","types","Event","type","date","Date","payload","Log","events","logEvent","push","create","now","edgeMapFactory","getEdgeType","edgeMap","safeReference","acceptsUndefined","hasEdge","tag","target","includes","length","addEdge","has","removeEdge","remove","getEdgeTag","nodeFactory","models","compose","identifier","concat","named","Node","graphFactory","nodeModels","options","isModelType","isIdentifierType","createNode","modelName","props","node","getId","uuid","label","afterCreate","initialize","root","rootNodeId","editMode","selectedNodes","global","dateFormat","timeFormat","dividers","lists","checkbox","showChildCount","showEdgeChips","Graph","createChild","edgeProps","edgeType","child","deleteNode","toggleSelectNode","clearSelected","toggleEditMode","reduce","prev","next","resolve","graphContext","React","createContext","GraphProvider","children","createElement","Provider","useGraph","selector","useContext","useObserver","ThemeProvider","prefersDarkMode","useMediaQuery","theme","useMemo","createMuiTheme","typography","fontFamily","join","palette","primary","main","background","default","shape","borderRadius","MuiButtonBase","disableRipple","overrides","MuiCssBaseline","html","userSelect","overscrollBehavior","maxWidth","margin","height","CssBaseline","useStyles","makeStyles","createStyles","item","itemText","NodeEditor","classes","isStateTreeNode","members","onSubmit","List","className","ListItem","dense","button","ListItemText","backgroundColor","color","text","marginBottom","spacing","toolbar","padding","backButton","visibility","pointerEvents","settingsButton","title","flexGrow","textAlign","overflowX","whiteSpace","textOverflow","Header","showTitle","AppBar","elevation","position","Toolbar","variant","IconButton","disabled","rootNode","undefined","edge","aria-label","onClick","history","back","Typography","fontSize","defaultProps","deleteButton","NodeActions","Button","startIcon","bottom","marginTop","body1","inputBase","iconButton","marginLeft","common","white","success","light","AddItem","useState","createInputText","setCreateInputText","handleChange","event","EditorState","createEmpty","preventDefault","InputBase","placeholder","inputProps","onChange","autoFocus","fullWidth","listItem","display","listItemIcon","minWidth","editItemText","chip","hint","cursor","paddingRight","secondaryActions","right","secondary","childButton","NodeListItem","navigate","useNavigate","isMouseDown","useRef","timer","listConfig","mouseDownHandler","e","current","setTimeout","clearTimeout","makeClickHandler","component","onMouseDown","onTouchStart","onMouseUp","onTouchEnd","Checkbox","checked","tabIndex","primaryTypographyProps","ListItemSecondaryAction","Chip","childCount","icon","size","to","Link","endIcon","list","addItem","EdgeList","edgeTag","NodeBrowser","currentNode","Settings","Route","Component","rest","Router","NodeViewer","PropertyEditor","ReactDOM","render","StrictMode","document","getElementById","URL","process","href","origin","addEventListener","fetch","headers","response","contentType","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.479a0506.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\n/* eslint-disable no-console */\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config): void {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config): void {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config): void {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      )\n    })\n}\n\nexport function unregister(): void {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport {\n  Instance,\n  onPatch,\n  getSnapshot,\n  getMembers,\n  applySnapshot,\n  IAnyModelType,\n} from 'mobx-state-tree'\nimport Dexie from 'dexie'\n\nexport async function persist(graph: Instance<IAnyModelType>): Promise<void> {\n  const db = new Dexie('default')\n  const tableNames = Object.keys(getMembers(graph).properties)\n  const tableConfig = Object.fromEntries(tableNames.map(name => [name, 'id']))\n\n  db.version(1).stores(tableConfig)\n\n  return Promise.all(\n    tableNames.map(name =>\n      db\n        .table(name)\n        .toArray()\n        .then(rows => [name, Object.fromEntries(rows.map(r => [r.id, r]))]),\n    ),\n  ).then(resolved => {\n    applySnapshot(graph, Object.fromEntries(resolved))\n    onPatch(graph, patch => {\n      const [typeName, id, propName] = patch.path.split('/').slice(1)\n      if (patch.op === 'add') {\n        db.table(typeName).put(getSnapshot(graph[typeName].get(id)))\n      } else if (patch.op === 'replace' || patch.op === 'remove') {\n        if (propName) {\n          db.table(typeName).update(id, {\n            [propName]: getSnapshot(graph[typeName].get(id)[propName]),\n          })\n        } else {\n          db.table(typeName).delete(id)\n        }\n      } else {\n        throw Error(`Unknown patch op '${patch.op}'`)\n      }\n    })\n  })\n}\n\nexport default persist\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport { types as t, SnapshotIn, IAnyType, Instance } from 'mobx-state-tree'\n\nconst Basic = t.union(\n  t.boolean,\n  t.string,\n  t.number,\n  t.array(t.late((): IAnyType => Basic)),\n  t.map(t.late((): IAnyType => Basic)),\n)\n\nexport const Config = t\n  .model('Config', {\n    name: t.maybe(t.string),\n    items: t.map(Basic),\n  })\n  .actions(self => ({\n    set(key: string, value: SnapshotIn<typeof Basic>) {\n      self.items.set(key, value)\n    },\n  }))\n  .views(self => ({\n    get(key: string): Instance<typeof Basic> {\n      return self.items.get(key)\n    },\n  }))\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport { types, IAnyType } from 'mobx-state-tree'\n\nconst Basic = types.union(\n  types.boolean,\n  types.string,\n  types.number,\n  types.late((): IAnyType => types.array(Basic)),\n)\n\nexport const Event = types.model('Event', {\n  type: types.string,\n  date: types.Date,\n  payload: types.maybe(Basic),\n})\n\nexport const Log = types\n  .model('Log', {\n    events: types.array(Event),\n  })\n  .actions(self => ({\n    logEvent(type: string, payload?: typeof Basic) {\n      self.events.push(\n        Event.create({\n          date: Date.now(),\n          payload,\n          type,\n        }),\n      )\n    },\n  }))\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport {\n  IAnyModelType,\n  IAnyType,\n  Instance,\n  isIdentifierType,\n  SnapshotIn,\n  isModelType,\n  types,\n} from 'mobx-state-tree'\nimport { v4 as uuid } from 'uuid'\n\nexport type ModelOrUnion = IAnyModelType | IAnyType\nexport type EdgeResolver = () => ModelOrUnion\nexport type ModelTable = Record<string, IAnyModelType>\n\nexport const edgeMapFactory = (getEdgeType: EdgeResolver): IAnyModelType =>\n  types\n    .model('EdgeMap', {\n      edgeMap: types.map(\n        types.array(\n          types.safeReference(types.late(getEdgeType), {\n            acceptsUndefined: false,\n          }),\n        ),\n      ),\n    })\n    .actions(self => ({\n      hasEdge(tag: string, target?: Instance<IAnyModelType>): boolean {\n        if (target) {\n          return Boolean(self.edgeMap.get(tag)?.includes(target))\n        } else {\n          return Boolean(self.edgeMap.get(tag)?.length)\n        }\n      },\n    }))\n    .actions(self => ({\n      addEdge(tag: string, target: Instance<IAnyModelType>): void {\n        if (!self.edgeMap.has(tag)) {\n          self.edgeMap.set(tag, [])\n        }\n\n        self.edgeMap.get(tag)?.push(target)\n      },\n\n      removeEdge(tag: string, target: Instance<IAnyModelType>): void {\n        if (!self.edgeMap.get(tag)?.remove(target)) {\n          throw Error(`Node '${self}' has no '${tag}' edge for '${target}'`)\n        }\n      },\n    }))\n    .views(self => ({\n      getEdgeTag(tag: string): void | Array<Instance<IAnyModelType>> {\n        return self.edgeMap.get(tag)\n      },\n    }))\n\nexport const nodeFactory = (\n  models: IAnyModelType | Array<IAnyModelType> = [],\n): IAnyModelType =>\n  types\n    .compose(\n      // @ts-ignore\n      ...[\n        types.model({\n          id: types.identifier,\n        }),\n      ].concat(models),\n    )\n    .named('Node')\n\nexport const Node = nodeFactory(edgeMapFactory(() => Node))\n\ninterface GraphFactoryOptions {\n  getId?: () => string\n}\n\nexport const graphFactory = (\n  nodeModels: ModelTable = { Node },\n  options: GraphFactoryOptions = {},\n): IAnyModelType =>\n  types\n    .model(\n      'Graph',\n      Object.fromEntries(\n        Object.keys(nodeModels).map(key => {\n          const model = nodeModels[key]\n\n          if (isModelType(model) && isIdentifierType(model.properties.id)) {\n            return [key, types.map(nodeModels[key])]\n          }\n\n          // Can't add an identifier because the model may be referenced\n          throw Error(`Model '${key}' requires 'id' identifier`)\n        }),\n      ),\n    )\n    .actions(self => ({\n      createNode(\n        modelName = 'Node',\n        props: Omit<SnapshotIn<IAnyModelType>, 'id'> = {},\n      ): Instance<IAnyModelType> {\n        if (!nodeModels[modelName]) {\n          throw Error(`No model named '${modelName}'`)\n        }\n\n        const node = nodeModels[modelName].create({\n          id: options.getId?.() ?? uuid(),\n          ...props,\n        })\n\n        self[modelName].put(node)\n\n        return node\n      },\n    }))\n\nexport const Graph = graphFactory()\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport { types, IAnyType } from 'mobx-state-tree'\n\nimport { nodeFactory, edgeMapFactory } from 'graph/factories'\nimport * as models from 'graph/models'\n\nexport const Config = nodeFactory(models.Config)\nexport const Node = nodeFactory([\n  models.Log,\n  edgeMapFactory(() =>\n    types.union(\n      types.late((): IAnyType => Node),\n      Config,\n    ),\n  ),\n])\n  .props({\n    label: types.maybe(types.string),\n  })\n  .actions(self => ({\n    afterCreate() {\n      self.logEvent('create')\n    },\n  }))\n  .views(self => ({\n    get childCount(): number {\n      return self.edgeMap.get('child')?.length ?? 0\n    },\n\n    get createDate(): Date {\n      return self.events[0]?.date\n    },\n  }))\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Instance } from 'mobx-state-tree'\nimport { useObserver } from 'mobx-react-lite'\n\nimport persist from './persist'\nimport { Graph as GraphModel } from './models'\n\nasync function initialize(graph: Instance<typeof Graph>): Promise<void> {\n  if (graph.Config.has('system')) {\n    return\n  }\n\n  const root = graph.createNode('Node', { label: 'Exuo' })\n\n  graph.createNode('Config', {\n    id: 'system',\n    items: {\n      rootNodeId: root.id,\n      editMode: false,\n      selectedNodes: [],\n    },\n  })\n\n  graph.createNode('Config', {\n    id: 'user',\n    items: {\n      global: {\n        dateFormat: '',\n        timeFormat: '',\n        dividers: false,\n      },\n      lists: {\n        number: false,\n        checkbox: false,\n        dividers: false,\n        showChildCount: true,\n        showEdgeChips: false,\n      },\n    },\n  })\n}\n\nconst Graph = GraphModel.actions(self => ({\n  afterCreate() {\n    const adapters = [persist, initialize]\n    adapters\n      .reduce(async (prev, next) => {\n        await prev\n        return next(self)\n      }, Promise.resolve())\n      .catch(error => {\n        throw Error(`Adapter error: ${error}`)\n      })\n  },\n}))\n\nexport const graphContext = React.createContext<Instance<typeof Graph>>(null)\nexport const GraphProvider: React.FunctionComponent<{\n  value?: Instance<typeof Graph>\n}> = ({ children, value }) =>\n  React.createElement(\n    graphContext.Provider,\n    { value: value ?? Graph.create() },\n    children,\n  )\n\nexport function useGraph<S>(selector: (s: Instance<typeof Graph>) => S): S {\n  const graph = React.useContext(graphContext)\n\n  if (graph) {\n    return useObserver(() => selector(graph))\n  }\n\n  throw Error('Cannot use graph before setup')\n}\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport { Instance, SnapshotIn, IAnyModelType } from 'mobx-state-tree'\n\nimport { graphFactory } from 'graph/factories'\nimport { Node, Config } from './Node'\n\nexport const Graph = graphFactory({ Node, Config })\n  .actions(self => ({\n    createChild<T extends IAnyModelType>(\n      node: Instance<typeof Node>,\n      edgeProps: SnapshotIn<T>,\n      edgeType = 'Node',\n    ): Instance<typeof Node> {\n      const child = self.createNode(edgeType, edgeProps)\n\n      node.addEdge('child', child)\n      child.addEdge('parent', node)\n\n      return child\n    },\n\n    deleteNode(node: Instance<typeof Node>) {\n      self.Node.delete(node.id)\n    },\n\n    toggleSelectNode(node: Instance<typeof Node>) {\n      const selectedNodes = self.Config.get('system').get('selectedNodes')\n      if (selectedNodes?.includes(node.id)) {\n        selectedNodes?.remove(node.id)\n      } else {\n        selectedNodes?.push(node.id)\n      }\n    },\n\n    clearSelected() {\n      self.Config.get('system').set('selectedNodes', [])\n    },\n\n    toggleEditMode() {\n      const editMode = self.Config.get('system').get('editMode')\n      self.Config.get('system').set('editMode', !editMode)\n      if (editMode) {\n        self.clearSelected()\n      }\n    },\n  }))\n  .views(self => ({\n    get rootNode() {\n      const config = self.Config.get('system')\n      return self.Node.get(config?.get('rootNodeId'))\n    },\n\n    get editMode() {\n      const config = self.Config.get('system')\n      return config?.get('editMode')\n    },\n\n    get selectedNodes() {\n      return self.Config.get('system')?.get('selectedNodes')\n    },\n  }))\n","import React from 'react'\nimport {\n  createMuiTheme,\n  ThemeProvider as MuiThemeProvider,\n} from '@material-ui/core/styles'\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nexport const ThemeProvider: React.FunctionComponent = ({ children }) => {\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)')\n  const theme = React.useMemo(\n    () =>\n      createMuiTheme({\n        typography: {\n          fontFamily: [\n            '-apple-system',\n            'system-ui',\n            'BlinkMacSystemFont',\n            '\"Segoe UI\"',\n            'Roboto',\n            '\"Helvetica Neue\"',\n            'Arial',\n            'sans-serif',\n          ].join(', '),\n        },\n\n        palette: {\n          primary: { main: '#f94d94' },\n          type: prefersDarkMode ? 'dark' : 'light',\n          background: {\n            default: prefersDarkMode ? '#000000' : '#ffffff',\n          },\n        },\n\n        shape: {\n          borderRadius: 3,\n        },\n\n        props: {\n          MuiButtonBase: {\n            disableRipple: true,\n          },\n        },\n\n        overrides: {\n          MuiCssBaseline: {\n            '@global': {\n              html: {\n                userSelect: 'none',\n                overscrollBehavior: 'none',\n                '-webkit-touch-callout': 'none',\n                maxWidth: '600px',\n                margin: 'auto',\n                '&, & body': {\n                  height: '100%',\n                },\n              },\n            },\n          },\n        },\n      }),\n    [prefersDarkMode],\n  )\n\n  return (\n    <MuiThemeProvider theme={theme}>\n      <CssBaseline />\n      {children}\n    </MuiThemeProvider>\n  )\n}\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { List, ListItem, ListItemText } from '@material-ui/core'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { getMembers, Instance, isStateTreeNode } from 'mobx-state-tree'\n\nimport { useGraph, Node } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {},\n    item: {},\n    itemText: {},\n  }),\n)\n\ninterface NodeEditorProps {\n  node?: Instance<typeof Node> | string\n  propName?: string\n  minimal?: boolean\n}\n\nconst NodeEditor: React.FunctionComponent<NodeEditorProps> = props => {\n  const classes = useStyles()\n\n  return useGraph(graph => {\n    let node = props.node\n    if (typeof node === 'string') {\n      node = graph.Node.get(props.node)\n    }\n\n    if (!isStateTreeNode(node)) {\n      return <></> // Loading\n    }\n\n    const members = getMembers(node)\n    const properties = Object.keys(members.properties)\n\n    const handleSubmit: React.EventHandler<React.SyntheticEvent> = () => {\n      console.log('submit')\n    }\n\n    return (\n      <form onSubmit={handleSubmit}>\n        <List className={classes.root}>\n          {properties.map(value => (\n            <ListItem dense button key={value} className={classes.item}>\n              <ListItemText\n                primary={value}\n                id={`list-label-${value}`}\n                className={classes.itemText}\n              />\n            </ListItem>\n          ))}\n        </List>\n      </form>\n    )\n  })\n}\n\nexport default NodeEditor\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Typography, AppBar, Toolbar, IconButton } from '@material-ui/core'\nimport ChevronLeft from '@material-ui/icons/ChevronLeft'\nimport Settings from '@material-ui/icons/Settings'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { Instance } from 'mobx-state-tree'\n\nimport { Node, useGraph } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      backgroundColor: theme.palette.background.default,\n      color: theme.palette.text.primary,\n      marginBottom: -theme.spacing(1),\n    },\n    toolbar: {\n      padding: theme.spacing(0, 2, 0, 2),\n    },\n    backButton: {\n      color: theme.palette.primary.main,\n      '&[disabled]': {\n        visibility: 'hidden',\n        pointerEvents: 'none',\n      },\n    },\n    settingsButton: {\n      visibility: 'hidden',\n      pointerEvents: 'none',\n    },\n    title: {\n      flexGrow: 1,\n      textAlign: 'center',\n      overflowX: 'hidden',\n      whiteSpace: 'nowrap',\n      textOverflow: 'ellipsis',\n    },\n  }),\n)\n\ninterface HeaderProps {\n  node: Instance<typeof Node>\n  showTitle?: boolean\n}\n\nconst Header: React.FunctionComponent<HeaderProps> = ({ node, showTitle }) => {\n  const classes = useStyles()\n  return useGraph(graph => (\n    <AppBar elevation={0} position=\"sticky\" className={classes.root}>\n      <Toolbar variant=\"dense\" className={classes.toolbar}>\n        <IconButton\n          disabled={graph.rootNode.id === node.id ? true : undefined}\n          edge=\"start\"\n          color=\"primary\"\n          aria-label=\"back\"\n          onClick={() => window.history.back()}\n          className={classes.backButton}\n        >\n          <ChevronLeft />\n        </IconButton>\n        <Typography variant=\"h6\" className={classes.title}>\n          {showTitle && node.label}\n        </Typography>\n        <IconButton\n          edge=\"end\"\n          aria-label=\"settings\"\n          onClick={() => graph.toggleEditMode()}\n          className={[\n            classes.settingsButton,\n            graph.editMode ? 'editMode' : '',\n          ].join(' ')}\n        >\n          <Settings fontSize=\"small\" />\n        </IconButton>\n      </Toolbar>\n    </AppBar>\n  ))\n}\n\nHeader.defaultProps = {\n  showTitle: true,\n}\n\nexport default Header\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Button, Typography } from '@material-ui/core'\nimport Delete from '@material-ui/icons/Delete'\nimport Edit from '@material-ui/icons/Edit'\nimport Folder from '@material-ui/icons/Folder'\nimport FileCopy from '@material-ui/icons/FileCopy'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { Instance } from 'mobx-state-tree'\n\nimport { Node, useGraph } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      textAlign: 'center',\n    },\n    button: {\n      margin: theme.spacing(0, 1, 0, 1),\n    },\n    deleteButton: {\n      '&:hover, &:focus': {\n        backgroundColor: 'inherit',\n        color: theme.palette.error.main,\n      },\n    },\n  }),\n)\n\ninterface NodeActionsProps {\n  node: Instance<typeof Node>\n}\n\nconst NodeActions: React.FunctionComponent<NodeActionsProps> = ({ node }) => {\n  const classes = useStyles()\n  return useGraph(graph => (\n    <div className={classes.root}>\n      <Typography variant=\"body2\">\n        {graph.selectedNodes.length} Selected\n      </Typography>\n      <Button startIcon={<Edit />} disabled className={classes.button}>\n        Modify\n      </Button>\n      <Button startIcon={<FileCopy />} disabled className={classes.button}>\n        Copy\n      </Button>\n      <Button startIcon={<Folder />} disabled className={classes.button}>\n        Move\n      </Button>\n      <Button\n        startIcon={<Delete />}\n        className={[classes.button, classes.deleteButton].join(' ')}\n      >\n        Delete\n      </Button>\n    </div>\n  ))\n}\n\nexport default NodeActions\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Instance } from 'mobx-state-tree'\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles'\nimport InputBase from '@material-ui/core/InputBase'\nimport IconButton from '@material-ui/core/IconButton'\nimport AddIcon from '@material-ui/icons/Add'\nimport { Editor, EditorState } from 'draft-js'\nimport 'draft-js/dist/Draft.css'\n\nimport NodeActions from './NodeActions'\nimport { useGraph, Node } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      position: 'sticky',\n      bottom: 0,\n      marginTop: -theme.spacing(1),\n      ...theme.typography.body1,\n      padding: 0,\n      background: theme.palette.background.default,\n    },\n\n    inputBase: {\n      ...theme.typography.body1,\n      '& input': {\n        padding: theme.spacing(1, 2, 1, 2),\n        height: 'auto',\n      },\n    },\n\n    iconButton: {\n      padding: 0,\n      marginLeft: -theme.spacing(4),\n      color: theme.palette.common.white,\n      backgroundColor: theme.palette.success.main,\n      '&:hover': {\n        backgroundColor: theme.palette.success.light,\n      },\n    },\n  }),\n)\n\ninterface AddItemProps {\n  node: Instance<typeof Node>\n}\n\nexport const AddItem: React.FunctionComponent<AddItemProps> = ({ node }) => {\n  const classes = useStyles()\n  const [createInputText, setCreateInputText] = React.useState('')\n\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>): void =>\n    setCreateInputText(event.target.value)\n\n  const [editorState, setEditorState] = React.useState(() =>\n    EditorState.createEmpty(),\n  )\n\n  return useGraph(graph => {\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>): void => {\n      event.preventDefault()\n      if (createInputText) {\n        graph.createChild(node, { label: createInputText })\n        setCreateInputText('')\n      }\n    }\n\n    /* <Editor */\n    /*   placeholder=\"Add item\" */\n    /*   editorState={editorState} */\n    /*   onChange={setEditorState} */\n    /* /> */\n\n    return (\n      <div className={classes.root}>\n        {graph.editMode ? (\n          <NodeActions node={node} />\n        ) : (\n          <form onSubmit={handleSubmit}>\n            <InputBase\n              placeholder=\"Add item\"\n              inputProps={{ 'aria-label': 'item name' }}\n              onChange={handleChange}\n              value={createInputText}\n              className={classes.inputBase}\n              margin={'none'}\n              autoFocus\n              fullWidth\n            />\n            {createInputText && (\n              <IconButton\n                type=\"submit\"\n                aria-label=\"add item\"\n                className={classes.iconButton}\n              >\n                <AddIcon fontSize=\"small\" />\n              </IconButton>\n            )}\n          </form>\n        )}\n      </div>\n    )\n  })\n}\n\nexport default AddItem\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { useNavigate, Link } from '@reach/router'\nimport {\n  Checkbox,\n  Chip,\n  InputBase,\n  Button,\n  ListItem,\n  ListItemSecondaryAction,\n  ListItemText,\n} from '@material-ui/core'\nimport AccountTreeIcon from '@material-ui/icons/AccountTree'\nimport NoteIcon from '@material-ui/icons/Note'\nimport ChevronRight from '@material-ui/icons/ChevronRight'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { Editor, EditorState } from 'draft-js'\nimport 'draft-js/dist/Draft.css'\nimport { Instance } from 'mobx-state-tree'\n\nimport { useGraph, Node } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {},\n    listItem: {},\n    itemText: {\n      display: 'inline-block',\n      margin: 0,\n      overflowX: 'hidden',\n      whiteSpace: 'nowrap',\n      textOverflow: 'ellipsis',\n      ...theme.typography.body1,\n    },\n    listItemIcon: {\n      minWidth: 'auto',\n    },\n    checkbox: {\n      padding: theme.spacing(0, 1, 0, 1),\n    },\n    editItemText: {\n      display: 'inline-block',\n      margin: 0,\n      overflowX: 'hidden',\n      whiteSpace: 'nowrap',\n      textOverflow: 'ellipsis',\n      ...theme.typography.body1,\n      '& input': {\n        height: 'auto',\n        padding: 0,\n      },\n    },\n    chip: {\n      pointerEvents: 'auto',\n      color: theme.palette.text.hint,\n      backgroundColor: 'transparent',\n      '&:hover': {\n        color: theme.palette.primary.main,\n        cursor: 'auto',\n      },\n      '& svg': {\n        pointerEvents: 'auto',\n        color: 'inherit',\n      },\n      '&:last-child .MuiChip-label': {\n        paddingRight: 0,\n      },\n    },\n    secondaryActions: {\n      right: 0,\n      color: theme.palette.text.secondary,\n    },\n    childButton: {\n      color: theme.palette.text.secondary,\n      '&:hover, &:focus': {\n        color: theme.palette.primary.main,\n        background: 'inherit',\n      },\n    },\n  }),\n)\n\ninterface NodeListItemProps {\n  node: Instance<typeof Node>\n}\n\nconst NodeListItem: React.FunctionComponent<NodeListItemProps> = ({\n  node,\n  ...props\n}) => {\n  const classes = useStyles()\n  const navigate = useNavigate()\n  const [editorState, setEditorState] = React.useState(() =>\n    EditorState.createEmpty(),\n  )\n  const isMouseDown = React.useRef(false)\n  const timer = React.useRef<ReturnType<typeof setTimeout>>()\n\n  return useGraph(graph => {\n    const listConfig = graph.Config.get('user')?.get('lists')\n\n    const showChildCount = listConfig?.get('showChildCount')\n    const showEdgeChips = listConfig?.get('showEdgeChips')\n\n    const mouseDownHandler: React.EventHandler<React.SyntheticEvent> = e => {\n      e.preventDefault()\n\n      isMouseDown.current = true\n      timer.current = setTimeout(() => {\n        isMouseDown.current = false\n        if (timer.current) {\n          clearTimeout(timer.current)\n        }\n\n        graph.toggleEditMode()\n      }, 390)\n    }\n\n    const makeClickHandler = (\n      node: Instance<typeof Node>,\n    ): React.EventHandler<React.SyntheticEvent> => {\n      return e => {\n        e.preventDefault()\n\n        if (!isMouseDown.current) {\n          return\n        }\n\n        if (graph.editMode) {\n          graph.toggleSelectNode(node)\n        } else {\n          navigate(`/${node.id}/`)\n        }\n\n        isMouseDown.current = false\n        if (timer.current) {\n          clearTimeout(timer.current)\n        }\n      }\n    }\n\n    return (\n      <ListItem\n        button\n        component={'li'}\n        onMouseDown={mouseDownHandler}\n        onTouchStart={mouseDownHandler}\n        onMouseUp={makeClickHandler(node)}\n        onTouchEnd={makeClickHandler(node)}\n        className={classes.listItem}\n      >\n        {graph.editMode ? (\n          <>\n            <Checkbox\n              checked={graph.selectedNodes.includes(node.id)}\n              tabIndex={-1}\n              color=\"primary\"\n              edge=\"start\"\n              className={classes.checkbox}\n            />\n            <ListItemText\n              primary={node.label}\n              primaryTypographyProps={{ display: 'inline' }}\n              className={classes.itemText}\n            />\n          </>\n        ) : (\n          <ListItemText\n            primary={node.label}\n            primaryTypographyProps={{ display: 'inline' }}\n            className={classes.itemText}\n          />\n        )}\n        <ListItemSecondaryAction className={classes.secondaryActions}>\n          {showEdgeChips && (\n            <>\n              <Chip\n                label={node.childCount}\n                icon={<AccountTreeIcon />}\n                size=\"small\"\n                to={`/${node.id}/`}\n                component={Link}\n                className={classes.chip}\n              />\n            </>\n          )}\n\n          {showChildCount && !showEdgeChips && node.childCount > 0 && (\n            <Button\n              endIcon={<ChevronRight />}\n              to={`/${node.id}/`}\n              component={Link}\n              className={classes.childButton}\n            >\n              {node.childCount}\n            </Button>\n          )}\n        </ListItemSecondaryAction>\n      </ListItem>\n    )\n  })\n}\n\nexport default NodeListItem\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { List } from '@material-ui/core'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { IAnyModelType, Instance } from 'mobx-state-tree'\n\nimport { Node, useGraph } from 'graph'\nimport AddItem from './AddItem'\nimport NodeListItem from './NodeListItem'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    list: {},\n    addItem: {},\n  }),\n)\n\ninterface EdgeListProps {\n  node: Instance<IAnyModelType>\n  edgeTag: string\n  className?: string\n}\n\nconst EdgeList: React.FunctionComponent<EdgeListProps> = ({\n  node,\n  edgeTag,\n  className,\n}) => {\n  const classes = useStyles()\n  return useGraph(graph => (\n    <>\n      <List aria-label=\"edge list\" className={classes.list}>\n        {node.edgeMap.get(edgeTag)?.map((item: Instance<typeof Node>) => (\n          <NodeListItem node={item} key={`${edgeTag}-${item.id}`} />\n        ))}\n      </List>\n      <AddItem node={node} />\n    </>\n  ))\n}\n\nexport default EdgeList\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\n\nimport { useGraph } from 'graph'\nimport Header from './Header'\nimport EdgeList from './EdgeList'\n\ninterface NodeBrowserProps {\n  node?: string\n}\n\nconst NodeBrowser: React.FunctionComponent<NodeBrowserProps> = ({ node }) => {\n  return useGraph(graph => {\n    let currentNode = graph.Node.get(node)\n\n    if (!currentNode) {\n      currentNode = graph.rootNode\n    }\n\n    if (!currentNode) {\n      return <></> // Loading\n    }\n\n    return (\n      <>\n        <Header node={currentNode} />\n        <EdgeList node={currentNode} edgeTag=\"child\" />\n      </>\n    )\n  })\n}\n\nexport default NodeBrowser\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Link } from '@reach/router'\n\nconst Settings: React.FunctionComponent = () => (\n  <>\n    <Link to=\"/\">Root</Link>\n    <Link to=\"/settings\">Settings</Link>\n  </>\n)\n\nexport default Settings\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { RouteComponentProps, Router as ReachRouter } from '@reach/router'\n\nimport PropertyEditor from './PropertyEditor'\nimport NodeViewer from './NodeViewer'\nimport Settings from './Settings'\n\ntype Props<T = unknown> = {\n  component: React.FunctionComponent<T>\n} & RouteComponentProps\n\nconst Route: React.FunctionComponent<Props> = ({\n  component: Component,\n  ...rest\n}) => <Component {...rest} />\n\nexport const Router: React.FunctionComponent = () => (\n  <ReachRouter>\n    <Route path=\"/\" component={NodeViewer} />\n    <Route path=\"/:node\" component={NodeViewer} />\n    <Route path=\"/:node/edit\" component={PropertyEditor} />\n    <Route path=\"/settings\" component={Settings} />\n  </ReachRouter>\n)\n\nexport default Router\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport 'mobx-react-lite/batchingForReactDom'\nimport * as serviceWorker from './serviceWorker'\n\nimport { GraphProvider } from './graph'\nimport { ThemeProvider } from './theme'\nimport Router from './components/Router'\n\nReactDOM.render(\n  <React.StrictMode>\n    <GraphProvider>\n      <ThemeProvider>\n        <Router />\n      </ThemeProvider>\n    </GraphProvider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\nserviceWorker.register()\n"],"sourceRoot":""}