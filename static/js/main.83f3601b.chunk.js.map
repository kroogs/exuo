{"version":3,"sources":["serviceWorker.ts","graph/models/Config.ts","graph/models/Log.ts","graph/factories.ts","graph/models/Node.ts","graph/models/Graph.ts","graph/setup.ts","theme.tsx","components/PropertyEditor.tsx","components/Header.tsx","components/AddItem.tsx","components/NodeListItem.tsx","components/EdgeList.tsx","components/NodeViewer.tsx","components/Settings.tsx","components/Router.tsx","index.tsx"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","Basic","t","union","boolean","string","number","late","array","Config","model","name","maybe","items","map","actions","self","set","key","value","views","get","types","Event","type","date","Date","payload","Log","events","logEvent","push","create","now","nodeFactory","models","compose","id","identifier","concat","named","edgeMapFactory","getEdgeType","edgeMap","safeReference","acceptsUndefined","hasEdge","tag","target","includes","length","addEdge","has","removeEdge","remove","Error","getEdgeTag","Node","graphFactory","nodeModels","options","Object","fromEntries","keys","isModelType","isIdentifierType","properties","createNode","modelName","props","node","getId","uuid","put","label","persist","graph","a","db","Dexie","tableNames","getMembers","tableConfig","version","stores","Promise","all","table","toArray","rows","r","resolved","applySnapshot","onPatch","patch","path","split","slice","typeName","propName","op","getSnapshot","update","delete","initialize","root","rootNodeId","editMode","Graph","afterCreate","reduce","prev","next","resolve","createChild","edgeProps","edgeType","child","deleteNode","toggleEditMode","graphContext","React","createContext","GraphProvider","children","createElement","Provider","useGraph","selector","useContext","useObserver","palette","primary","main","typography","fontFamily","ThemeProvider","prefersDarkMode","useMediaQuery","theme","useMemo","createMuiTheme","background","default","MuiButtonBase","disableRipple","overrides","MuiCssBaseline","html","userSelect","overscrollBehavior","CssBaseline","useStyles","makeStyles","createStyles","item","itemText","NodeEditor","classes","isStateTreeNode","members","onSubmit","List","className","ListItem","dense","button","ListItemText","backgroundColor","color","text","marginBottom","spacing","toolbar","padding","backButton","visibility","pointerEvents","moreButton","title","flexGrow","textAlign","overflowX","whiteSpace","textOverflow","Header","showTitle","AppBar","elevation","position","Toolbar","variant","IconButton","disabled","rootNode","undefined","edge","aria-label","onClick","history","back","Typography","join","fontSize","defaultProps","display","flexDirection","alignItems","inputBase","body1","height","iconButton","common","white","success","light","AddItem","useState","createInputText","setCreateInputText","handleChange","event","preventDefault","InputBase","placeholder","inputProps","onChange","margin","autoFocus","fullWidth","listItem","paddingTop","paddingBottom","secondaryActions","secondary","deleteButton","getLabel","NodeListItem","to","component","Link","e","editable","ListItemSecondaryAction","childCount","list","addItem","bottom","marginTop","EdgeList","edgeTag","NodeBrowser","currentNode","Settings","Route","Component","rest","Router","NodeViewer","PropertyEditor","ReactDOM","render","StrictMode","document","getElementById","URL","process","href","origin","addEventListener","fetch","headers","response","contentType","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.83f3601b.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\n/* eslint-disable no-console */\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config): void {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config): void {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config): void {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      )\n    })\n}\n\nexport function unregister(): void {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport { types as t, SnapshotIn, IAnyType, Instance } from 'mobx-state-tree'\n\nconst Basic = t.union(\n  t.boolean,\n  t.string,\n  t.number,\n  t.late((): IAnyType => t.array(Basic)),\n)\n\nexport const Config = t\n  .model('Config', {\n    name: t.maybe(t.string),\n    items: t.map(Basic),\n  })\n  .actions(self => ({\n    set(key: string, value: SnapshotIn<typeof Basic>) {\n      self.items.set(key, value)\n    },\n  }))\n  .views(self => ({\n    get(key: string): Instance<typeof Basic> {\n      return self.items.get(key)\n    },\n  }))\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport { types, IAnyType } from 'mobx-state-tree'\n\nconst Basic = types.union(\n  types.boolean,\n  types.string,\n  types.number,\n  types.late((): IAnyType => types.array(Basic)),\n)\n\nexport const Event = types.model('Event', {\n  type: types.string,\n  date: types.Date,\n  payload: types.maybe(Basic),\n})\n\nexport const Log = types\n  .model('Log', {\n    events: types.array(Event),\n  })\n  .actions(self => ({\n    logEvent(type: string, payload?: typeof Basic) {\n      self.events.push(\n        Event.create({\n          date: Date.now(),\n          payload,\n          type,\n        }),\n      )\n    },\n  }))\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport {\n  IAnyModelType,\n  IAnyType,\n  Instance,\n  isIdentifierType,\n  SnapshotIn,\n  isModelType,\n  types,\n} from 'mobx-state-tree'\nimport { v4 as uuid } from 'uuid'\n\nexport const nodeFactory = (\n  models: IAnyModelType | Array<IAnyModelType> = [],\n): IAnyModelType =>\n  types\n    .compose(\n      // @ts-ignore\n      ...[\n        types.model({\n          id: types.identifier,\n        }),\n      ].concat(models),\n    )\n    .named('Node')\n\nexport type ModelOrUnion = IAnyModelType | IAnyType\nexport type EdgeResolver = () => ModelOrUnion\nexport type ModelTable = Record<string, IAnyModelType>\n\nexport const edgeMapFactory = (getEdgeType: EdgeResolver): IAnyModelType =>\n  types\n    .model('EdgeMap', {\n      edgeMap: types.map(\n        types.array(\n          types.safeReference(types.late(getEdgeType), {\n            acceptsUndefined: false,\n          }),\n        ),\n      ),\n    })\n    .actions(self => ({\n      hasEdge(tag: string, target?: Instance<IAnyModelType>): boolean {\n        if (target) {\n          return Boolean(self.edgeMap.get(tag)?.includes(target))\n        } else {\n          return Boolean(self.edgeMap.get(tag)?.length)\n        }\n      },\n    }))\n    .actions(self => ({\n      addEdge(tag: string, target: Instance<IAnyModelType>): void {\n        if (!self.edgeMap.has(tag)) {\n          self.edgeMap.set(tag, [])\n        }\n\n        self.edgeMap.get(tag)?.push(target)\n      },\n\n      removeEdge(tag: string, target: Instance<IAnyModelType>): void {\n        if (!self.edgeMap.get(tag)?.remove(target)) {\n          throw Error(`Node '${self}' has no '${tag}' edge for '${target}'`)\n        }\n      },\n    }))\n    .views(self => ({\n      getEdgeTag(tag: string): void | Array<Instance<IAnyModelType>> {\n        return self.edgeMap.get(tag)\n      },\n    }))\n\nexport const Node = nodeFactory(edgeMapFactory(() => Node))\n\ninterface GraphFactoryOptions {\n  getId?: () => string\n}\n\nexport const graphFactory = (\n  nodeModels: ModelTable = { Node },\n  options: GraphFactoryOptions = {},\n): IAnyModelType =>\n  types\n    .model(\n      'Graph',\n      Object.fromEntries(\n        Object.keys(nodeModels).map(key => {\n          const model = nodeModels[key]\n\n          if (isModelType(model) && isIdentifierType(model.properties.id)) {\n            return [key, types.map(nodeModels[key])]\n          }\n\n          // Can't add an identifier because the model may be referenced\n          throw Error(`Model '${key}' requires 'id' identifier`)\n        }),\n      ),\n    )\n    .actions(self => ({\n      createNode(\n        modelName = 'Node',\n        props: Omit<SnapshotIn<IAnyModelType>, 'id'> = {},\n      ): Instance<IAnyModelType> {\n        if (!nodeModels[modelName]) {\n          throw Error(`No model named '${modelName}'`)\n        }\n\n        const node = nodeModels[modelName].create({\n          id: options.getId?.() ?? uuid(),\n          ...props,\n        })\n\n        self[modelName].put(node)\n\n        return node\n      },\n    }))\n\nexport const Graph = graphFactory()\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport { types, IAnyType } from 'mobx-state-tree'\n\nimport { nodeFactory, edgeMapFactory } from 'graph/factories'\nimport * as models from 'graph/models'\n\nexport const Config = nodeFactory(models.Config)\nexport const Node = nodeFactory([\n  models.Log,\n  edgeMapFactory(() =>\n    types.union(\n      types.late((): IAnyType => Node),\n      Config,\n    ),\n  ),\n])\n  .props({\n    label: types.maybe(types.string),\n  })\n  .views(self => ({\n    get childCount(): number | void {\n      return self.edgeMap.get('child')?.length\n    },\n  }))\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport {\n  Instance,\n  onPatch,\n  getSnapshot,\n  getMembers,\n  applySnapshot,\n  SnapshotIn,\n  IAnyModelType,\n} from 'mobx-state-tree'\nimport Dexie from 'dexie'\n\nimport { graphFactory } from 'graph/factories'\nimport { Node, Config } from './Node'\n\nasync function persist(graph: Instance<typeof Graph>): Promise<void> {\n  const db = new Dexie('default')\n  const tableNames = Object.keys(getMembers(graph).properties)\n  const tableConfig = Object.fromEntries(tableNames.map(name => [name, 'id']))\n\n  db.version(1).stores(tableConfig)\n\n  return Promise.all(\n    tableNames.map(name =>\n      db\n        .table(name)\n        .toArray()\n        .then(rows => [name, Object.fromEntries(rows.map(r => [r.id, r]))]),\n    ),\n  ).then(resolved => {\n    applySnapshot(graph, Object.fromEntries(resolved))\n    onPatch(graph, patch => {\n      const [typeName, id, propName] = patch.path.split('/').slice(1)\n      if (patch.op === 'add') {\n        db.table(typeName).put(getSnapshot(graph[typeName].get(id)))\n      } else if (patch.op === 'replace' || patch.op === 'remove') {\n        if (propName) {\n          db.table(typeName).update(id, {\n            [propName]: getSnapshot(graph[typeName].get(id)[propName]),\n          })\n        } else {\n          db.table(typeName).delete(id)\n        }\n      } else {\n        throw Error(`Unknown patch op '${patch.op}'`)\n      }\n    })\n  })\n}\n\nasync function initialize(graph: Instance<typeof Graph>): Promise<void> {\n  if (graph.Config.has('graph')) {\n    return\n  }\n\n  const root = graph.createNode('Node', { label: 'Root' })\n  graph.createNode('Config', {\n    id: 'graph',\n    items: { rootNodeId: root.id, editMode: false },\n  })\n}\n\nexport const Graph = graphFactory({ Node, Config })\n  .actions(self => ({\n    afterCreate() {\n      const adapters = [persist, initialize]\n      adapters\n        .reduce(async (prev, next) => {\n          await prev\n          return next(self)\n        }, Promise.resolve())\n        .catch(error => {\n          throw Error(`Adapter error: ${error}`)\n        })\n    },\n\n    createChild<T extends IAnyModelType>(\n      node: Instance<typeof Node>,\n      edgeProps: SnapshotIn<T>,\n      edgeType = 'Node',\n    ): Instance<typeof Node> {\n      const child = self.createNode(edgeType, edgeProps)\n\n      node.addEdge('child', child)\n      child.addEdge('parent', node)\n\n      return child\n    },\n\n    deleteNode(node: Instance<typeof Node>) {\n      self.Node.delete(node.id)\n    },\n\n    toggleEditMode() {\n      const editMode = self.Config.get('graph').get('editMode')\n      self.Config.get('graph').set('editMode', !editMode)\n    },\n  }))\n  .views(self => ({\n    get rootNode() {\n      const config = self.Config.get('graph')\n      return self.Node.get(config?.get('rootNodeId'))\n    },\n\n    get editMode() {\n      const config = self.Config.get('graph')\n      return config?.get('editMode')\n    },\n  }))\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Instance } from 'mobx-state-tree'\nimport { useObserver } from 'mobx-react-lite'\n\nimport { Graph } from './models'\n\nexport const graphContext = React.createContext<Instance<typeof Graph>>(null)\nexport const GraphProvider: React.FunctionComponent<{\n  value?: Instance<typeof Graph>\n}> = ({ children, value }) =>\n  React.createElement(\n    graphContext.Provider,\n    { value: value ?? Graph.create() },\n    children,\n  )\n\nexport function useGraph<S>(selector: (s: Instance<typeof Graph>) => S): S {\n  const graph = React.useContext(graphContext)\n\n  if (graph) {\n    return useObserver(() => selector(graph))\n  }\n\n  throw Error('Cannot use graph before setup')\n}\n","import React from 'react'\nimport {\n  createMuiTheme,\n  ThemeProvider as MuiThemeProvider,\n} from '@material-ui/core/styles'\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\n// '#9ce12e', // green\n// '#a378fe', // purple\n// '#34c3ff' // blue\n// rgb(220, 0, 78) // pink?\n\nexport const palette = {\n  primary: {\n    main: '#34c3ff',\n  },\n}\n\nexport const typography = {\n  fontFamily:\n    '-apple-system, system-ui, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\n}\n\nexport const ThemeProvider: React.FunctionComponent = ({ children }) => {\n  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)')\n  const theme = React.useMemo(\n    () =>\n      createMuiTheme({\n        typography,\n        palette: {\n          ...palette,\n          type: prefersDarkMode ? 'dark' : 'light',\n          background: {\n            default: prefersDarkMode ? '#000000' : '#ffffff',\n          },\n        },\n        props: {\n          MuiButtonBase: {\n            disableRipple: true,\n          },\n        },\n        overrides: {\n          MuiCssBaseline: {\n            '@global': {\n              html: {\n                userSelect: 'none',\n                overscrollBehavior: 'none',\n              },\n            },\n          },\n        },\n      }),\n    [prefersDarkMode],\n  )\n\n  return (\n    <MuiThemeProvider theme={theme}>\n      <CssBaseline />\n      {children}\n    </MuiThemeProvider>\n  )\n}\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { List, ListItem, ListItemText } from '@material-ui/core'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { getMembers, Instance, isStateTreeNode } from 'mobx-state-tree'\n\nimport { useGraph, Node } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {},\n    item: {},\n    itemText: {},\n  }),\n)\n\ninterface NodeEditorProps {\n  node?: Instance<typeof Node> | string\n  propName?: string\n  minimal?: boolean\n}\n\nconst NodeEditor: React.FunctionComponent<NodeEditorProps> = props => {\n  const classes = useStyles()\n\n  return useGraph(graph => {\n    let node = props.node\n    if (typeof node === 'string') {\n      node = graph.Node.get(props.node)\n    }\n\n    if (!isStateTreeNode(node)) {\n      return <></> // Loading\n    }\n\n    const members = getMembers(node)\n    const properties = Object.keys(members.properties)\n\n    const handleSubmit: React.EventHandler<React.SyntheticEvent> = () => {\n      console.log('submit')\n    }\n\n    return (\n      <form onSubmit={handleSubmit}>\n        <List className={classes.root}>\n          {properties.map(value => (\n            <ListItem dense button key={value} className={classes.item}>\n              <ListItemText\n                primary={value}\n                id={`list-label-${value}`}\n                className={classes.itemText}\n              />\n            </ListItem>\n          ))}\n        </List>\n      </form>\n    )\n  })\n}\n\nexport default NodeEditor\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Typography, AppBar, Toolbar, IconButton } from '@material-ui/core'\nimport ChevronLeft from '@material-ui/icons/ChevronLeft'\nimport MoreHoriz from '@material-ui/icons/MoreHoriz'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { Instance } from 'mobx-state-tree'\n\nimport { Node, useGraph } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      backgroundColor: theme.palette.background.default,\n      color: theme.palette.text.primary,\n      marginBottom: -theme.spacing(1),\n    },\n    toolbar: {\n      padding: theme.spacing(0, 2, 0, 2),\n    },\n    backButton: {\n      color: theme.palette.primary.main,\n      '&[disabled]': {\n        visibility: 'hidden',\n        pointerEvents: 'none',\n      },\n    },\n    moreButton: {\n      '&.editMode': {\n        color: theme.palette.error.main,\n      },\n    },\n    title: {\n      flexGrow: 1,\n      textAlign: 'center',\n      overflowX: 'hidden',\n      whiteSpace: 'nowrap',\n      textOverflow: 'ellipsis',\n    },\n  }),\n)\n\ninterface HeaderProps {\n  node: Instance<typeof Node>\n  showTitle?: boolean\n}\n\nconst Header: React.FunctionComponent<HeaderProps> = ({ node, showTitle }) => {\n  const classes = useStyles()\n  return useGraph(graph => (\n    <AppBar elevation={0} position=\"sticky\" className={classes.root}>\n      <Toolbar variant=\"dense\" className={classes.toolbar}>\n        <IconButton\n          disabled={graph.rootNode.id === node.id ? true : undefined}\n          edge=\"start\"\n          color=\"primary\"\n          aria-label=\"back\"\n          onClick={() => window.history.back()}\n          className={classes.backButton}\n        >\n          <ChevronLeft />\n        </IconButton>\n        {showTitle && (\n          <Typography variant=\"h6\" className={classes.title}>\n            {node.label}\n          </Typography>\n        )}\n        <IconButton\n          edge=\"end\"\n          aria-label=\"more\"\n          onClick={() => graph.toggleEditMode()}\n          className={[\n            classes.moreButton,\n            graph.editMode ? 'editMode' : '',\n          ].join(' ')}\n        >\n          <MoreHoriz fontSize=\"small\" />\n        </IconButton>\n      </Toolbar>\n    </AppBar>\n  ))\n}\n\nHeader.defaultProps = {\n  showTitle: true,\n}\n\nexport default Header\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Instance } from 'mobx-state-tree'\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles'\nimport InputBase from '@material-ui/core/InputBase'\nimport IconButton from '@material-ui/core/IconButton'\nimport AddIcon from '@material-ui/icons/Add'\n\nimport { useGraph, Node } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'center',\n      padding: theme.spacing(1, 2, 1, 2),\n      background: theme.palette.background.default,\n    },\n    inputBase: {\n      ...theme.typography.body1,\n      '& input': {\n        padding: 0,\n        height: 'auto',\n      },\n    },\n    iconButton: {\n      padding: 0,\n      color: theme.palette.common.white,\n      backgroundColor: theme.palette.success.main,\n      '&:hover': {\n        backgroundColor: theme.palette.success.light,\n      },\n    },\n  }),\n)\n\ninterface AddItemProps {\n  node: Instance<typeof Node>\n  className: string\n}\n\nexport const AddItem: React.FunctionComponent<AddItemProps> = ({\n  node,\n  className,\n}) => {\n  const classes = useStyles()\n  const [createInputText, setCreateInputText] = React.useState('')\n\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>): void =>\n    setCreateInputText(event.target.value)\n\n  return useGraph(graph => {\n    const handleSubmit = (event: React.FormEvent<HTMLFormElement>): void => {\n      event.preventDefault()\n      if (createInputText) {\n        graph.createChild(node, { label: createInputText })\n        setCreateInputText('')\n      }\n    }\n\n    return (\n      <form\n        className={[className, classes.root].join(' ')}\n        onSubmit={handleSubmit}\n      >\n        <InputBase\n          placeholder=\"Add item\"\n          inputProps={{ 'aria-label': 'item name' }}\n          onChange={handleChange}\n          value={createInputText}\n          className={classes.inputBase}\n          margin={'none'}\n          autoFocus\n          fullWidth\n        />\n        {createInputText && (\n          <IconButton\n            type=\"submit\"\n            aria-label=\"add item\"\n            className={classes.iconButton}\n          >\n            <AddIcon fontSize=\"small\" />\n          </IconButton>\n        )}\n      </form>\n    )\n  })\n}\n\nexport default AddItem\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Link } from '@reach/router'\nimport {\n  ListItem,\n  ListItemText,\n  ListItemSecondaryAction,\n  IconButton,\n} from '@material-ui/core'\nimport Clear from '@material-ui/icons/Clear'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { IAnyStateTreeNode, Instance } from 'mobx-state-tree'\n\nimport { useGraph, Node } from 'graph'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {},\n    listItem: {\n      padding: theme.spacing(2),\n      paddingTop: theme.spacing(1),\n      paddingBottom: theme.spacing(1),\n    },\n    itemText: {\n      display: 'inline-block',\n      margin: 0,\n      overflowX: 'hidden',\n      whiteSpace: 'nowrap',\n      textOverflow: 'ellipsis',\n      ...theme.typography.body1,\n    },\n    secondaryActions: {\n      color: theme.palette.text.secondary,\n    },\n    deleteButton: {\n      color: theme.palette.error.main,\n    },\n  }),\n)\n\nconst getLabel = (item: IAnyStateTreeNode): string => item.label ?? item.id\n\ninterface NodeListItemProps {\n  node: Instance<typeof Node>\n  onClick?: React.EventHandler<React.SyntheticEvent>\n  editable?: boolean\n}\n\nconst NodeListItem: React.FunctionComponent<NodeListItemProps> = ({\n  node,\n  onClick,\n  ...props\n}) => {\n  const classes = useStyles()\n  return useGraph(graph => {\n    const handleClick: React.EventHandler<React.SyntheticEvent> = e => {\n      if (graph.editMode) {\n        e.preventDefault()\n        console.log('click')\n        return\n      }\n      if (!props.editable) {\n        return\n      }\n    }\n\n    /* <ListItem */\n    /*   onClick={onClick} */\n    /*   onDoubleClick={handleDoubleClick} */\n    /*   className={classes.root} */\n    /*   button */\n    /*   dense */\n    /* > */\n    /*   <ListItemText className={classes.itemText} primary={getLabel(node)} /> */\n    /* </ListItem> */\n\n    return (\n      <ListItem\n        button\n        to={`/${node.id}`}\n        component={Link}\n        onClick={handleClick}\n        className={classes.listItem}\n      >\n        <ListItemText primary={getLabel(node)} className={classes.itemText} />\n        <ListItemSecondaryAction className={classes.secondaryActions}>\n          {node.childCount}\n          {graph.editMode && (\n            <IconButton\n              edge=\"end\"\n              aria-label=\"delete\"\n              onClick={() => graph.deleteNode(node)}\n              className={classes.deleteButton}\n            >\n              <Clear fontSize=\"small\" />\n            </IconButton>\n          )}\n        </ListItemSecondaryAction>\n      </ListItem>\n    )\n  })\n}\n\nNodeListItem.defaultProps = {\n  editable: true,\n}\n\nexport default NodeListItem\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { List } from '@material-ui/core'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles'\nimport { IAnyModelType, Instance } from 'mobx-state-tree'\n\nimport { Node, useGraph } from 'graph'\nimport AddItem from './AddItem'\nimport NodeListItem from './NodeListItem'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    list: {},\n    addItem: {\n      position: 'sticky',\n      bottom: 0,\n      marginTop: -theme.spacing(1),\n      ...theme.typography.body1,\n    },\n  }),\n)\n\ninterface EdgeListProps {\n  node: Instance<IAnyModelType>\n  edgeTag: string\n  className?: string\n}\n\nconst EdgeList: React.FunctionComponent<EdgeListProps> = ({\n  node,\n  edgeTag,\n  className,\n}) => {\n  const classes = useStyles()\n  return useGraph(graph => (\n    <>\n      <List aria-label=\"edge list\" className={classes.list}>\n        {node.edgeMap.get(edgeTag)?.map((item: Instance<typeof Node>) => (\n          <NodeListItem node={item} key={`${edgeTag}-${item.id}`} editable />\n        ))}\n      </List>\n      <AddItem node={node} className={classes.addItem} />\n    </>\n  ))\n}\n\nexport default EdgeList\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\n\nimport { useGraph } from 'graph'\nimport Header from './Header'\nimport EdgeList from './EdgeList'\n\ninterface NodeBrowserProps {\n  node?: string\n}\n\nconst NodeBrowser: React.FunctionComponent<NodeBrowserProps> = ({ node }) => {\n  return useGraph(graph => {\n    let currentNode = graph.Node.get(node)\n\n    if (!currentNode) {\n      currentNode = graph.rootNode\n    }\n\n    if (!currentNode) {\n      return <></> // Loading\n    }\n\n    return (\n      <>\n        <Header node={currentNode} />\n        <EdgeList node={currentNode} edgeTag=\"child\" />\n      </>\n    )\n  })\n}\n\nexport default NodeBrowser\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { Link } from '@reach/router'\n\nconst Settings: React.FunctionComponent = () => (\n  <>\n    <Link to=\"/\">Root</Link>\n    <Link to=\"/settings\">Settings</Link>\n  </>\n)\n\nexport default Settings\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport { RouteComponentProps, Router as ReachRouter } from '@reach/router'\n\nimport PropertyEditor from './PropertyEditor'\nimport NodeViewer from './NodeViewer'\nimport Settings from './Settings'\n\ntype Props<T = unknown> = {\n  component: React.FunctionComponent<T>\n} & RouteComponentProps\n\nconst Route: React.FunctionComponent<Props> = ({\n  component: Component,\n  ...rest\n}) => <Component {...rest} />\n\nexport const Router: React.FunctionComponent = () => (\n  <ReachRouter>\n    <Route path=\"/\" component={NodeViewer} />\n    <Route path=\"/:node\" component={NodeViewer} />\n    <Route path=\"/:node/edit\" component={PropertyEditor} />\n    <Route path=\"/settings\" component={Settings} />\n  </ReachRouter>\n)\n\nexport default Router\n","/*\n * Copyright © 2020 Ty Dira <ty@dira.dev>\n *\n * This file is part of Exuo.\n\n * Exuo is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * Exuo is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n\n * You should have received a copy of the GNU Affero General Public License\n * along with Exuo.  If not, see <https://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport 'mobx-react-lite/batchingForReactDom'\nimport * as serviceWorker from './serviceWorker'\n\nimport { GraphProvider } from './graph'\nimport { ThemeProvider } from './theme'\nimport Router from './components/Router'\n\nReactDOM.render(\n  <React.StrictMode>\n    <GraphProvider>\n      <ThemeProvider>\n        <Router />\n      </ThemeProvider>\n    </GraphProvider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\nserviceWorker.register()\n"],"sourceRoot":""}